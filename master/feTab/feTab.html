<!doctype html>
<!--
	feTab
	Version: 1.0
-->
<html lang="ko">
<head>
	<meta charset="utf-8">
	<title>feTab</title>
	<style>
		/* feTab common */
		.feTab {
			overflow: hidden;
			position: relative;
		}
		.feTabMenu {
			float: left;
			margin: 0;
		}
		.feTabMenu:hover {cursor: pointer;}
		.feTabContent {
			overflow: hidden;
			position: absolute;
			left: 0;
			top: 0;
		}
	</style>
	<script src="http://code.jquery.com/jquery.min.js"></script>
	<script>
		;(function($, window, document, undefined) {
			/* feTab */
			$.fn.feTab = function(options) {
				// feTab default options
				var _defaults = {
					menuElem: 'h2', // Menu element(Element)
					eventString: 'click focus', // Events(String)
					currentClass: 'current', // Current class(String)
					startPannel: 1 // Start pannel index
				},
				// Marge default options with new settings
				_options = $.extend({}, _defaults, options);
				return this.each(function() {
					var $this = $(this).addClass('feTab'),
						// Set menu, container, content elements
						$feTabMenu = $this.find('> ' + _options.menuElem)
							.addClass('feTabMenu').attr('tabindex', '0'),
						$feTabContent = $feTabMenu.next('div')
							.addClass('feTabContent'),
						// Get container, content size info
						containerWidth = $this.width(),
						containerTopPadding = parseInt($this.css('padding-top')),
						contentHeight = $feTabContent.map(setArray).get(),
						// Outline style for keyboard evnet
						outlineStyle = false,
						// Set menu size value for content position
						menuHeight = $feTabMenu.map(setArray).get(),
						menuHeight = Math.max.apply(Math, menuHeight),
						menuTotalWidth = 0,
						menuTotalHeight = 0,
						menuTotalLine = 1;
					setContentTopPos(); // Reset content top postion
					// Common event
					$feTabMenu.on(_options.eventString, function(e) {
						var $tgContent = $(this).next($feTabContent),
							tgIdx = $feTabContent.index($tgContent);
						e.preventDefault();
						if ( $(this).hasClass(_options.currentClass) ) return false;
						// Remove outline
						if ( !outlineStyle ) $(this).css('outline', 'none');
						// Toggle current class, visible
						$feTabMenu.add($feTabContent)
							.removeClass(_options.currentClass)
							.not($feTabMenu).css({
								'height': '0',
								'padding': '0'
							});
						$(this).addClass(_options.currentClass)
							.next($feTabContent)
								.addClass(_options.currentClass).css({
									'height': '',
									'padding': ''
								});
						resizeContainer(tgIdx); // Resize container
					})
					// Start Pannel
					.eq(_options.startPannel - 1).trigger('click');
					// Extra event
					// Keyboard event(Focus in contents)
					$feTabContent.find('*').on('focus', function() {
						var $tgContent = $(this).closest($feTabContent),
							$tgMenu = $tgContent.prev($feTabMenu);
						$tgMenu.trigger('click');
					}).end().parents().on('keydown', function(e) { // Reset outline
						if ( e.keyCode == 9 && !outlineStyle ) {
							outlineStyle = true;
							$feTabMenu.css('outline', '');
						};
					});
					// Window resize event
					$(window).on('resize', function() {
						var $tgContent = $feTabContent.filter('.' + _options.currentClass),
							tgIdx = $feTabContent.index($tgContent);
						// Reset value
						containerWidth = $this.width(),
						containerTopPadding = parseInt($this.css('padding-top')),
						contentHeight = $feTabContent.css('height', 'auto')
							.map(setArray).get(),
						menuHeight = $feTabMenu.map(setArray).get(),
						menuHeight = Math.max.apply(Math, menuHeight),
						menuTotalWidth = 0;
						// Change visiblity
						$feTabContent.not('.' + _options.currentClass)
							.css('height', '0');
						// Call func for content position, resize container
						setContentTopPos();
						resizeContainer(tgIdx);
					});
					// Set content el top position
					function setContentTopPos() {
						$feTabMenu.each(function() {
							menuTotalWidth += $(this).outerWidth(true);
						});
						menuTotalLine = Math.ceil(menuTotalWidth/containerWidth),
						menuTotalHeight = menuHeight * menuTotalLine + containerTopPadding;
						$feTabContent.css('top', menuTotalHeight);
					};
					// Set Array
					function setArray() {
						return $(this).outerHeight(true);
					};
					// Resize container height
					function resizeContainer(tgIdx) {
						var containerHeight = menuHeight * menuTotalLine 
							+ contentHeight[tgIdx];
						$this.css('height', containerHeight);
					};
				});
			};
			/* //feTab */
		})(jQuery, window, document);
	</script>
	<script>
		/* User script */
		$(function() {
			$(".myClass").feTab();
		});
	</script>
</head>
<body>
	<!-- feTab -->
	<h1>feTab</h1>
	<div class="myClass">
		<h2>(1). Title</h2>
		<div>1: Lorem ipsum dolor sit amet, consectetur adipisicing elit. Deserunt, maxime, optio, numquam praesentium assumenda maiores nemo doloribus nisi quia qui perspiciatis aperiam. Velit, id odio accusantium omnis perferendis cum ex.</div>
		<h2>(2). B</h2>
		<div>
			<!-- Blank test -->
		</div>
		<h2>(3). Title</h2>
		<div>
			<p>3: <span>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sed, quam eligendi reprehenderit. Voluptas, eligendi, in, molestiae culpa facere enim perspiciatis sint dolorum ratione totam nisi porro repellat ipsa velit minima!</span>
			<span>Ut, ullam, quidem, commodi ea nisi ad quas cum quisquam totam est impedit recusandae dicta. Expedita, debitis, alias, vitae quidem illum voluptatem possimus similique aut optio quibusdam ut doloremque molestias?</span>
			<span>Suscipit, laudantium, doloremque sequi repudiandae maiores saepe hic omnis blanditiis earum necessitatibus corrupti officiis enim adipisci laboriosam officia iusto ipsa nostrum aliquam quos ducimus sint placeat non tenetur inventore optio!</span></p>
			<ul>
				<li><a href="/">Tab 3-1</a></li>
				<li><a href="/">Tab 3-2</a></li>
				<li><a href="/">Tab 3-3</a></li>
			</ul>
		</div>
		<h2>(4). Tab Menu Title</h2>
		<div>
			<p>4: Lorem ipsum dolor sit amet, consectetur adipisicing elit. Velit, error, temporibus eveniet nulla assumenda eum quasi est beatae eligendi architecto eaque dignissimos voluptate similique possimus nobis perferendis placeat neque harum.</p>
		</div>
	</div>
	<!-- //feTab -->
</body>
</html>